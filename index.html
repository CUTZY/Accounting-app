<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <title>Fung's Accounting</title>
    <style>
      /* Mobile-first CSS */
      
      /* Base mobile styles */
      body {
        font-size: 14px;
        line-height: 1.4;
      }

      /* Mobile-first navigation */
      .mobile-header {
        background: #2c3e50;
        color: white;
        padding: 15px;
        position: sticky;
        top: 0;
        z-index: 1000;
        box-shadow: 0 2px 4px rgba(0,0,0,0.1);
      }

      .mobile-nav-toggle {
        background: none;
        border: none;
        color: white;
        font-size: 1.2rem;
        padding: 8px;
        border-radius: 4px;
      }

      .mobile-nav-toggle:focus {
        outline: 2px solid #3498db;
        color: white;
      }

      .mobile-nav-toggle:hover {
        background: rgba(255,255,255,0.1);
        color: white;
      }

      /* Sidebar - mobile first (hidden by default) */
      .sidebar {
        position: fixed;
        top: 0;
        left: -100%;
        width: 80%;
        max-width: 300px;
        height: 100vh;
        background: #2c3e50;
        z-index: 1050;
        transition: left 0.3s ease;
        overflow-y: auto;
        padding-top: 20px;
      }

      .sidebar.show {
        left: 0;
      }

      .sidebar-overlay {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0,0,0,0.5);
        z-index: 1040;
        display: none;
      }

      .sidebar-overlay.show {
        display: block;
      }

      .sidebar .nav-link {
        color: #ecf0f1;
        padding: 15px 20px;
        border-radius: 0;
        margin: 0;
        border-bottom: 1px solid rgba(255,255,255,0.1);
        transition: all 0.3s;
        display: flex;
        align-items: center;
      }

      .sidebar .nav-link i {
        margin-right: 10px;
        width: 20px;
        text-align: center;
      }

      .sidebar .nav-link:hover, 
      .sidebar .nav-link.active {
        background: #3498db;
        color: white;
      }

      .sidebar-close {
        position: absolute;
        top: 15px;
        right: 15px;
        background: none;
        border: none;
        color: white;
        font-size: 1.5rem;
        padding: 5px;
      }

      /* Main content - mobile first */
      .main-content {
        padding: 15px;
        background: #f8f9fa;
        min-height: calc(100vh - 70px);
      }

      /* Cards - mobile optimized */
      .card {
        margin-bottom: 20px;
        border-radius: 8px;
        box-shadow: 0 2px 4px rgba(0,0,0,0.1);
      }

      .card-header {
        background: #3498db;
        color: white;
        font-weight: bold;
        padding: 15px;
        border-radius: 8px 8px 0 0;
      }

      .card-body {
        padding: 15px;
      }

      /* Summary cards - mobile stacked */
      .summary-card {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        border: none;
        margin-bottom: 15px;
        text-align: center;
      }

      .summary-card .card-body {
        padding: 20px 15px;
      }

      .summary-card h5 {
        font-size: 0.9rem;
        margin-bottom: 10px;
        opacity: 0.9;
      }

      .summary-card h3 {
        font-size: 1.5rem;
        margin: 0;
        font-weight: bold;
      }

      /* Buttons - mobile optimized */
      .btn {
        padding: 12px 16px;
        font-size: 14px;
        border-radius: 6px;
        min-height: 44px; /* Touch-friendly */
        display: inline-flex;
        align-items: center;
        justify-content: center;
      }

      .btn i {
        margin-right: 8px;
      }

      .quick-action-btn {
        width: 100%;
        margin-bottom: 10px;
      }

      /* Tables - mobile scrollable */
      .table-responsive {
        border-radius: 6px;
        overflow-x: auto;
        -webkit-overflow-scrolling: touch;
      }

      .table {
        font-size: 13px;
        margin-bottom: 0;
      }

      .table th,
      .table td {
        padding: 10px 8px;
        white-space: nowrap;
      }

      /* Modal optimizations for mobile */
      .modal-dialog {
        margin: 10px;
        max-width: calc(100% - 20px);
      }

      .modal-content {
        border-radius: 8px;
      }

      .modal-header {
        padding: 15px;
        border-bottom: 1px solid #dee2e6;
      }

      .modal-body {
        padding: 15px;
      }

      .modal-footer {
        padding: 15px;
        border-top: 1px solid #dee2e6;
      }

      /* Form inputs - mobile optimized */
      .form-control {
        padding: 12px;
        font-size: 16px; /* Prevents zoom on iOS */
        border-radius: 6px;
        min-height: 44px;
      }

      .form-group {
        margin-bottom: 20px;
      }

      .form-group label {
        font-weight: 600;
        margin-bottom: 8px;
        color: #495057;
      }

      /* Transaction lines for mobile */
      .transaction-line {
        border: 1px solid #dee2e6;
        border-radius: 6px;
        padding: 15px;
        margin-bottom: 15px;
        background: #f8f9fa;
      }

      /* Balance indicators */
      .balance-positive {
        color: #27ae60;
        font-weight: bold;
      }

      .balance-negative {
        color: #e74c3c;
        font-weight: bold;
      }

      /* Account type headers */
      .account-type-header {
        background: #34495e;
        color: white;
        padding: 12px 15px;
        margin: 15px 0 10px 0;
        border-radius: 6px;
        font-weight: 600;
      }

      /* Page headers */
      .page-header {
        margin-bottom: 20px;
        padding-bottom: 15px;
        border-bottom: 2px solid #e9ecef;
      }

      .page-header h2 {
        font-size: 1.5rem;
        margin: 0;
        color: #2c3e50;
      }

      /* Alert styles */
      .alert {
        border-radius: 6px;
        padding: 15px;
        margin-bottom: 20px;
      }

      /* Responsive breakpoints */
      
      /* Small devices (landscape phones, 576px and up) */
      @media (min-width: 576px) {
        .modal-dialog {
          margin: 30px auto;
          max-width: 500px;
        }
        
        .summary-card h3 {
          font-size: 1.8rem;
        }
      }

      /* Medium devices (tablets, 768px and up) */
      @media (min-width: 768px) {
        body {
          font-size: 16px;
        }

        .mobile-header {
          display: none;
        }

        .sidebar {
          position: fixed;
          left: 0;
          width: 250px;
          padding-top: 20px;
        }

        .sidebar-overlay {
          display: none !important;
        }

        .main-content {
          margin-left: 250px;
          padding: 30px;
        }

        .quick-action-btn {
          width: auto;
          margin: 0 5px;
          min-width: 150px;
        }

        .summary-card {
          margin-bottom: 20px;
        }

        .page-header h2 {
          font-size: 2rem;
        }

        .modal-dialog {
          max-width: 600px;
        }
      }

      /* Large devices (desktops, 992px and up) */
      @media (min-width: 992px) {
        .sidebar {
          width: 280px;
        }

        .main-content {
          margin-left: 280px;
          padding: 40px;
        }

        .modal-dialog.modal-lg {
          max-width: 800px;
        }
      }

      /* Extra large devices (large desktops, 1200px and up) */
      @media (min-width: 1200px) {
        .container-fluid {
          max-width: 1400px;
          margin: 0 auto;
        }
      }

      /* Dark mode support for modern devices */
      @media (prefers-color-scheme: dark) {
        /* Optional: Add dark mode styles here */
      }

      /* Reduced motion for accessibility */
      @media (prefers-reduced-motion: reduce) {
        .sidebar,
        .btn,
        .nav-link {
          transition: none;
        }
      }

      /* High contrast mode support */
      @media (prefers-contrast: high) {
        .card {
          border: 2px solid #000;
        }
        
        .btn {
          border: 2px solid;
        }
      }

      /* Account action buttons - positioned on the right */
      .account-actions {
        display: flex;
        justify-content: flex-end;
        align-items: center;
        gap: 8px;
      }

      .account-actions .btn {
        min-width: auto;
        padding: 6px 10px;
        min-height: auto;
        border-radius: 4px;
        transition: all 0.2s ease;
      }

      .account-actions .btn:hover {
        transform: translateY(-1px);
        box-shadow: 0 2px 4px rgba(0,0,0,0.2);
      }

      .account-actions .btn-outline-primary:hover {
        background-color: #007bff;
        border-color: #007bff;
        color: white;
      }

      .account-actions .btn-outline-danger:hover {
        background-color: #dc3545;
        border-color: #dc3545;
        color: white;
      }

      /* Account row hover effect */
      .account-row:hover {
        background-color: #f8f9fa;
        border-radius: 4px;
        transition: background-color 0.2s ease;
      }

      /* Mobile responsive adjustments for account actions */
      @media (max-width: 767px) {
        .account-actions {
          flex-direction: column;
          gap: 4px;
        }

        .account-actions .btn {
          width: 100%;
          font-size: 12px;
          padding: 4px 8px;
        }
      }
    </style>
  </head>
  <body>
    <!-- Mobile Header -->
    <div class="mobile-header d-md-none">
      <div class="d-flex justify-content-between align-items-center">
        <button class="mobile-nav-toggle" onclick="toggleMobileNav()" aria-label="Toggle navigation">
          <i class="fas fa-bars"></i>
        </button>
        <h5 class="mb-0">
          <i class="fas fa-calculator"></i> Fung's Accounting
        </h5>
        <div style="width: 40px;"></div> <!-- Spacer for centering -->
      </div>
    </div>

    <!-- Sidebar Overlay -->
    <div class="sidebar-overlay" onclick="closeMobileNav()"></div>

    <!-- Sidebar -->
    <nav class="sidebar">
      <button class="sidebar-close d-md-none" onclick="closeMobileNav()" aria-label="Close navigation">
        <i class="fas fa-times"></i>
      </button>
      
      <div class="text-center mb-4 d-none d-md-block">
        <h4 class="text-white">
          <i class="fas fa-calculator"></i> Fung's Accounting
        </h4>
      </div>
      
      <ul class="nav flex-column">
        <li class="nav-item">
          <a class="nav-link active" href="#" onclick="showTab('dashboard'); closeMobileNav();">
            <i class="fas fa-tachometer-alt"></i> Dashboard
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="#" onclick="showTab('chart-accounts'); closeMobileNav();">
            <i class="fas fa-list"></i> Chart of Accounts
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="#" onclick="showTab('journal-entries'); closeMobileNav();">
            <i class="fas fa-book"></i> Journal Entries
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="#" onclick="showTab('trial-balance'); closeMobileNav();">
            <i class="fas fa-balance-scale"></i> Trial Balance
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="#" onclick="showTab('balance-sheet'); closeMobileNav();">
            <i class="fas fa-chart-bar"></i> Balance Sheet
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="#" onclick="showTab('income-statement'); closeMobileNav();">
            <i class="fas fa-chart-line"></i> Income Statement
          </a>
        </li>
      </ul>
    </nav>

    <!-- Main Content -->
    <main class="main-content">
      <!-- Dashboard Tab -->
      <div id="dashboard" class="tab-content">
        <div class="page-header">
          <div class="d-flex flex-column flex-md-row justify-content-between align-items-start align-items-md-center">
            <h2><i class="fas fa-tachometer-alt"></i> Dashboard</h2>
            <div class="mt-3 mt-md-0 w-100 w-md-auto">
              <button class="btn btn-primary quick-action-btn" onclick="showTab('journal-entries')">
                <i class="fas fa-plus"></i> New Entry
              </button>
              <button class="btn btn-success quick-action-btn" onclick="showTab('chart-accounts')">
                <i class="fas fa-cog"></i> Manage Accounts
              </button>
            </div>
          </div>
        </div>

        <div class="row">
          <div class="col-12 col-sm-6 col-lg-3">
            <div class="card summary-card">
              <div class="card-body">
                <h5><i class="fas fa-coins"></i> Total Assets</h5>
                <h3 id="total-assets">$0.00</h3>
              </div>
            </div>
          </div>
          <div class="col-12 col-sm-6 col-lg-3">
            <div class="card summary-card">
              <div class="card-body">
                <h5><i class="fas fa-credit-card"></i> Total Liabilities</h5>
                <h3 id="total-liabilities">$0.00</h3>
              </div>
            </div>
          </div>
          <div class="col-12 col-sm-6 col-lg-3">
            <div class="card summary-card">
              <div class="card-body">
                <h5><i class="fas fa-piggy-bank"></i> Total Equity</h5>
                <h3 id="total-equity">$0.00</h3>
              </div>
            </div>
          </div>
          <div class="col-12 col-sm-6 col-lg-3">
            <div class="card summary-card">
              <div class="card-body">
                <h5><i class="fas fa-chart-line"></i> Net Income</h5>
                <h3 id="net-income">$0.00</h3>
              </div>
            </div>
          </div>
        </div>

        <div class="row">
          <div class="col-12 col-lg-6">
            <div class="card">
              <div class="card-header">
                <i class="fas fa-clock"></i> Recent Journal Entries
              </div>
              <div class="card-body">
                <div id="recent-entries">
                  <p class="text-muted text-center">No recent entries found</p>
                </div>
              </div>
            </div>
          </div>
          <div class="col-12 col-lg-6">
            <div class="card">
              <div class="card-header">
                <i class="fas fa-exclamation-triangle"></i> Account Alerts
              </div>
              <div class="card-body">
                <div id="account-alerts">
                  <p class="text-success"><i class="fas fa-check"></i> All accounts balanced</p>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Chart of Accounts Tab -->
      <div id="chart-accounts" class="tab-content" style="display: none;">
        <div class="page-header">
          <div class="d-flex flex-column flex-md-row justify-content-between align-items-start align-items-md-center">
            <h2><i class="fas fa-list"></i> Chart of Accounts</h2>
            <button class="btn btn-primary mt-3 mt-md-0" onclick="showAddAccountModal()">
              <i class="fas fa-plus"></i> Add Account
            </button>
          </div>
        </div>

        <div class="card">
          <div class="card-body">
            <div id="accounts-list">
              <!-- Accounts will be loaded here -->
            </div>
          </div>
        </div>
      </div>

      <!-- Journal Entries Tab -->
      <div id="journal-entries" class="tab-content" style="display: none;">
        <div class="page-header">
          <div class="d-flex flex-column flex-md-row justify-content-between align-items-start align-items-md-center">
            <h2><i class="fas fa-book"></i> Journal Entries</h2>
            <button class="btn btn-primary mt-3 mt-md-0" onclick="showAddEntryModal()">
              <i class="fas fa-plus"></i> New Entry
            </button>
          </div>
        </div>

        <div class="card">
          <div class="card-body">
            <div class="table-responsive">
              <table class="table table-hover">
                <thead class="thead-dark">
                  <tr>
                    <th>Date</th>
                    <th>Reference</th>
                    <th>Description</th>
                    <th>Account</th>
                    <th>Debit</th>
                    <th>Credit</th>
                    <th>Actions</th>
                  </tr>
                </thead>
                <tbody id="journal-entries-table">
                  <!-- Entries will be loaded here -->
                </tbody>
              </table>
            </div>
          </div>
        </div>
      </div>

      <!-- Trial Balance Tab -->
      <div id="trial-balance" class="tab-content" style="display: none;">
        <div class="page-header">
          <div class="d-flex flex-column flex-md-row justify-content-between align-items-start align-items-md-center">
            <h2><i class="fas fa-balance-scale"></i> Trial Balance</h2>
            <button class="btn btn-secondary mt-3 mt-md-0" onclick="generateTrialBalance()">
              <i class="fas fa-refresh"></i> Refresh
            </button>
          </div>
        </div>

        <div class="card">
          <div class="card-body">
            <div class="table-responsive">
              <table class="table">
                <thead class="thead-dark">
                  <tr>
                    <th>Account</th>
                    <th>Type</th>
                    <th>Debit</th>
                    <th>Credit</th>
                  </tr>
                </thead>
                <tbody id="trial-balance-table">
                  <!-- Trial balance will be loaded here -->
                </tbody>
                <tfoot>
                  <tr class="table-info font-weight-bold">
                    <td colspan="2">TOTALS</td>
                    <td id="total-debits">$0.00</td>
                    <td id="total-credits">$0.00</td>
                  </tr>
                </tfoot>
              </table>
            </div>
          </div>
        </div>
      </div>

      <!-- Balance Sheet Tab -->
      <div id="balance-sheet" class="tab-content" style="display: none;">
        <div class="page-header">
          <div class="d-flex flex-column flex-md-row justify-content-between align-items-start align-items-md-center">
            <h2><i class="fas fa-chart-bar"></i> Balance Sheet</h2>
            <button class="btn btn-secondary mt-3 mt-md-0" onclick="generateBalanceSheet()">
              <i class="fas fa-refresh"></i> Refresh
            </button>
          </div>
        </div>

        <div class="row">
          <div class="col-12 col-lg-6">
            <div class="card">
              <div class="card-header text-center">ASSETS</div>
              <div class="card-body" id="assets-section">
                <!-- Assets will be loaded here -->
              </div>
            </div>
          </div>
          <div class="col-12 col-lg-6">
            <div class="card">
              <div class="card-header text-center">LIABILITIES & EQUITY</div>
              <div class="card-body" id="liabilities-equity-section">
                <!-- Liabilities & Equity will be loaded here -->
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Income Statement Tab -->
      <div id="income-statement" class="tab-content" style="display: none;">
        <div class="page-header">
          <div class="d-flex flex-column flex-md-row justify-content-between align-items-start align-items-md-center">
            <h2><i class="fas fa-chart-line"></i> Income Statement</h2>
            <button class="btn btn-secondary mt-3 mt-md-0" onclick="generateIncomeStatement()">
              <i class="fas fa-refresh"></i> Refresh
            </button>
          </div>
        </div>

        <div class="card">
          <div class="card-body" id="income-statement-content">
            <!-- Income statement will be loaded here -->
          </div>
        </div>
      </div>
    </main>

    <!-- Add Account Modal -->
    <div class="modal fade" id="addAccountModal" tabindex="-1">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title">Add New Account</h5>
            <button type="button" class="close" data-dismiss="modal">
              <span>&times;</span>
            </button>
          </div>
          <div class="modal-body">
            <form id="addAccountForm">
              <div class="form-group">
                <label>Account Number</label>
                <input type="text" class="form-control" id="accountNumber" required>
              </div>
              <div class="form-group">
                <label>Account Name</label>
                <input type="text" class="form-control" id="accountName" required>
              </div>
              <div class="form-group">
                <label>Account Type</label>
                <select class="form-control" id="accountType" required>
                  <option value="">Select Type</option>
                  <option value="Asset">Asset</option>
                  <option value="Liability">Liability</option>
                  <option value="Equity">Equity</option>
                  <option value="Revenue">Revenue</option>
                  <option value="Expense">Expense</option>
                </select>
              </div>
              <div class="form-group">
                <label>Description</label>
                <textarea class="form-control" id="accountDescription" rows="3"></textarea>
              </div>
            </form>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
            <button type="button" class="btn btn-primary" onclick="addAccount()">Add Account</button>
          </div>
        </div>
      </div>
    </div>

    <!-- Add Journal Entry Modal -->
    <div class="modal fade" id="addEntryModal" tabindex="-1">
      <div class="modal-dialog modal-lg">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title">New Journal Entry</h5>
            <button type="button" class="close" data-dismiss="modal">
              <span>&times;</span>
            </button>
          </div>
          <div class="modal-body">
            <form id="addEntryForm">
              <div class="row">
                <div class="col-12 col-md-6">
                  <div class="form-group">
                    <label>Date</label>
                    <input type="date" class="form-control" id="entryDate" required>
                  </div>
                </div>
                <div class="col-12 col-md-6">
                  <div class="form-group">
                    <label>Reference</label>
                    <input type="text" class="form-control" id="entryReference" placeholder="Optional reference">
                  </div>
                </div>
              </div>
              <div class="form-group">
                <label>Description</label>
                <textarea class="form-control" id="entryDescription" rows="2" required></textarea>
              </div>
              
              <h6>Transaction Lines</h6>
              <div id="transaction-lines">
                <div class="transaction-line">
                  <div class="row">
                    <div class="col-12 col-md-6">
                      <div class="form-group">
                        <label>Account</label>
                        <select class="form-control account-select" required>
                          <option value="">Select Account</option>
                        </select>
                      </div>
                    </div>
                    <div class="col-6 col-md-3">
                      <div class="form-group">
                        <label>Debit</label>
                        <input type="number" step="0.01" class="form-control debit-amount" onchange="updateTotals()">
                      </div>
                    </div>
                    <div class="col-6 col-md-3">
                      <div class="form-group">
                        <label>Credit</label>
                        <input type="number" step="0.01" class="form-control credit-amount" onchange="updateTotals()">
                      </div>
                    </div>
                    <div class="col-12 text-right">
                      <button type="button" class="btn btn-sm btn-danger" onclick="removeTransactionLine(this)">
                        <i class="fas fa-trash"></i> Remove
                      </button>
                    </div>
                  </div>
                </div>
              </div>
              
              <div class="d-flex flex-column flex-md-row justify-content-between align-items-start align-items-md-center mb-3">
                <button type="button" class="btn btn-secondary mb-3 mb-md-0" onclick="addTransactionLine()">
                  <i class="fas fa-plus"></i> Add Line
                </button>
                <div class="text-left text-md-right">
                  <div><strong>Total Debits: $<span id="total-debits-entry">0.00</span></strong></div>
                  <div><strong>Total Credits: $<span id="total-credits-entry">0.00</span></strong></div>
                  <div><span id="balance-status" class="text-danger">Out of Balance</span></div>
                </div>
              </div>
            </form>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
            <button type="button" class="btn btn-primary" id="save-entry-btn" onclick="addJournalEntry()">Save Entry</button>
          </div>
        </div>
      </div>
    </div>

    <!-- Scripts -->
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    <script>
      // Mobile navigation functions
      function toggleMobileNav() {
        const sidebar = document.querySelector('.sidebar');
        const overlay = document.querySelector('.sidebar-overlay');
        
        sidebar.classList.toggle('show');
        overlay.classList.toggle('show');
        
        // Prevent body scroll when menu is open
        if (sidebar.classList.contains('show')) {
          document.body.style.overflow = 'hidden';
        } else {
          document.body.style.overflow = '';
        }
      }

      function closeMobileNav() {
        const sidebar = document.querySelector('.sidebar');
        const overlay = document.querySelector('.sidebar-overlay');
        
        sidebar.classList.remove('show');
        overlay.classList.remove('show');
        document.body.style.overflow = '';
      }

      // Close mobile nav when clicking outside or on escape
      document.addEventListener('keydown', function(e) {
        if (e.key === 'Escape') {
          closeMobileNav();
        }
      });

      // Prevent zoom on form inputs for iOS
      if (/iPad|iPhone|iPod/.test(navigator.userAgent)) {
        document.addEventListener('touchstart', function() {}, true);
      }
    </script>
    <script src="app.js"></script>
  </body>
</html>
